-----BEGIN CERTIFICATE-----
MIIEMzCCA9mgAwIBAgIBKjAKBggqhkjOPQQDAjBJMRAwDgYDVQQDEwdUZXN0IENB
MQswCQYDVQQGEwJVUzEWMBQGA1UEChMNQm90YW4gUHJvamVjdDEQMA4GA1UECxMH
VGVzdGluZzAeFw0yNDAxMDEwMDAwMDBaFw0yNzAxMDEwMDAwMDBaMGMxJDAiBgNV
BAMTG011bHRpLU5hbWUgVGVzdCBDZXJ0aWZpY2F0ZTELMAkGA1UEBhMCREUxEjAQ
BgNVBAoTCVRlc3QgQ29ycDEaMBgGA1UECxMRWC41MDkgVGVzdGluZyBMYWIwWTAT
BgcqhkjOPQIBBggqhkjOPQMBBwNCAAT4iUt3sNUng53QKFAvzlMgJLlZxxtyndX6
IucTWTNV13JU0MOeOdS1REj1JbatMLmreqIIFOGud+t57ou7YCdho4ICljCCApIw
IQYDVR0OBBoEGF9fFjTjQB6f1+v1UKk/6Xus1OhKDpjqgjAOBgNVHQ8BAf8EBAMC
B4AwggEmBgNVHREEggEdMIIBGYESaW5mb0B4NTA5LWxhYnMuY29tgRV0ZXN0aW5n
QHg1MDktbGFicy5jb22CEnRlc3QueDUwOS1sYWJzLmNvbYITdHJhaWwueDUwOS1s
YWJzLmNvbYIVdmVyc3VjaC54NTA5LWxhYnMuY29tpCcwJTETMBEGA1UEAxMKRmly
c3QgTmFtZTEOMAwGA1UECxMFTGFiIDGkJjAkMRIwEAYDVQQDEwlMYXN0IE5hbWUx
DjAMBgNVBAsTBUxhYiAzpCgwJjEUMBIGA1UEAxMLTWlkZGxlIE5hbWUxDjAMBgNV
BAsTBUxhYiAyhhRodHRwOi8veDUwOS1sYWJzLmNvbYYVaHR0cHM6Ly94NTA5LWxh
YnMuY29thwR/AAABMIH/BgNVHRIEgfcwgfSCFXRlc3QueDUwOS1sYWJzLWNhLmNv
bYIWdHJhaWwueDUwOS1sYWJzLWNhLmNvbYIYdmVyc3VjaC54NTA5LWxhYnMtY2Eu
Y29tpCQwIjERMA8GA1UEAxMIRmlyc3QgQ0ExDTALBgNVBAsTBENBIDGkIzAhMRAw
DgYDVQQDEwdMYXN0IENBMQ0wCwYDVQQLEwRDQSAzpCUwIzESMBAGA1UEAxMJTWlk
ZGxlIENBMQ0wCwYDVQQLEwRDQSAyhhdodHRwOi8veDUwOS1sYWJzLWNhLmNvbYYY
aHR0cHM6Ly94NTA5LWxhYnMtY2EuY29thwTAqAEBMAwGA1UdEwEB/wQCMAAwIwYD
VR0jBBwwGoAY9DficXI3Yj7ff1cCpqhwpiFOXDo716+IMAoGCCqGSM49BAMCA0gA
MEUCIASrUtXryIn1kOTy6A9Z79IXft7mrBim/32QUHQoET+oAiEAtTJlv9rjKu0i
RJIp66gNT3MRf/g5HNFgvMJOH2HRDhA=
-----END CERTIFICATE-----

auto dn = Botan::X509_DN({{"X520.CommonName", "Multi-Name Test Certificate"},
                          {"X520.Country", "DE"},
                          {"X520.Organization", "Test Corp"},
                          {"X520.OrganizationalUnit", "X.509 Testing Lab"}});

auto exts = Botan::Extensions();
exts.add(std::make_unique<Botan::Cert_Extension::Basic_Constraints>(false, 0));
exts.add(std::make_unique<Botan::Cert_Extension::Key_Usage>(Botan::Key_Constraints::DigitalSignature));

auto san = Botan::AlternativeName();
san.add_email("testing@x509-labs.com");
san.add_email("info@x509-labs.com");
san.add_dns("test.x509-labs.com");
san.add_dns("versuch.x509-labs.com");
san.add_dns("trail.x509-labs.com");
san.add_uri("https://x509-labs.com");
san.add_uri("http://x509-labs.com");
san.add_dn(Botan::X509_DN({{"X520.CommonName", "First Name"}, {"X520.OrganizationalUnit", "Lab 1"}}));
san.add_dn(Botan::X509_DN({{"X520.CommonName", "Middle Name"}, {"X520.OrganizationalUnit", "Lab 2"}}));
san.add_dn(Botan::X509_DN({{"X520.CommonName", "Last Name"}, {"X520.OrganizationalUnit", "Lab 3"}}));
san.add_ipv4_address(Botan::string_to_ipv4("127.0.0.1").value());
exts.add(std::make_unique<Botan::Cert_Extension::Subject_Alternative_Name>(san));

auto ian = Botan::AlternativeName();
// email deliberately not set
ian.add_dns("test.x509-labs-ca.com");
ian.add_dns("versuch.x509-labs-ca.com");
ian.add_dns("trail.x509-labs-ca.com");
ian.add_uri("https://x509-labs-ca.com");
ian.add_uri("http://x509-labs-ca.com");
ian.add_dn(Botan::X509_DN({{"X520.CommonName", "First CA"}, {"X520.OrganizationalUnit", "CA 1"}}));
ian.add_dn(Botan::X509_DN({{"X520.CommonName", "Middle CA"}, {"X520.OrganizationalUnit", "CA 2"}}));
ian.add_dn(Botan::X509_DN({{"X520.CommonName", "Last CA"}, {"X520.OrganizationalUnit", "CA 3"}}));
ian.add_ipv4_address(Botan::string_to_ipv4("192.168.1.1").value());
exts.add(std::make_unique<Botan::Cert_Extension::Issuer_Alternative_Name>(ian));

auto req = Botan::PKCS10_Request::create(*somekey, dn, exts, some_hash_fn, somerng);
auto crt = someca.sign_request(req, somerng, Botan::BigInt(42), from_date(-1, 01, 01), from_date(2, 01, 01));
std::cout << crt.PEM_encode() << '\n';
