# KeyShareClientHello (variant of KeyShare extension) consists of:
#     - Client Key Share Length (2 bytes)
#     - vector of KeyShareEntry:
#           - Group (2 bytes)
#           - Key Exchange Length (2 bytes)
#           - Key Exchange (vector of bytes[Key Exchange Length])
#
# Groups               - The list of groups to be supported
# Offered_Groups (opt) - The list of groups to be offered in key exchange
# Rng_Data             - Pool of random number generator output (for key generation)
# Expected_Content     - The expected serialized output of the Key_Share extension
#
# Note: secp256r1 should always come last! If it finds an RNG that is still seeded after key generation,
#       it will opportunistically pull additional data for some blinding mechanism. That would otherwise
#       screw up the test case.

[key_share_CH_offers]

# INDIVIDUAL GROUPS (supported and offered)

Groups           = x25519
Rng_Data         = 49af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea5005
Expected_Content = 0024001d002099381de560e4bd43d23d8e435a7dbafeb3c06e51c13cae4d5413691e529aaf2c

Groups           = secp256r1
Rng_Data         = 49af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea5005
Expected_Content = 0045001700410486E8631CECD233F133F6FC99156D8BB504DB91DEC753C31AEA8AEC3C874221653C986F7B1D00FD4EBFD3F48BCC2CDE3E9C94442B4F53BF2F906B3ECEE6EA12F0

Groups           = ffdhe/ietf/2048
Rng_Data         = 49af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540
Expected_Content = 0104010001004854C74CDEB35C2DD056CC4F2CBF21C2E5A2E09803B7C7B9E040621CF1A9DA9D2EE334B0A8A6EC52B534C223EB14A14E41EE4BC2FB75C95292035EA869D9D5D1C25C648E55F5D6E0885257F971C981ED14B4FFF0C54D1C703AEFE72FB2B2721D52649F21D5E7F956EADE5BE93530AA8FA47D4970ACF6DCDD56F010D59549C510C9C3B8EF4E9F4D96B23AB450B32762EC7729CD95328F3F53B841A6555AFAEF8E5F1C7533AEBE75BE62AF07ECE1F1EE80D72835E654EA9BECE03BAFD25BE9F1EE3C027F55947EFF34AC0BC9C43E32944D44FCEEE462E91680FF7648B95BE4FF7CAB60A9AB66775BBD8494CFFF1ED6F7338124C9E03C9A972247B36FF6AC72C078

# this test data has two leading zero bytes in 'public value'
# RFC 8446 Ch. 4.2.8.1:
#   ... encoded as a big-endian integer and padded to
#   the left with zeros to the size of p in bytes
Groups           = ffdhe/ietf/2048
Rng_Data         = DF6FCF9D290232720DA33E6AA1AF27F1C2839F744A8A20DE6EC48DDA
Expected_Content = 010401000100000004D506A10F44DBC242F62F2952322E4CB697D3B9782D874DE2FC75C36B9476776ACFCCE977D5D15F6762C4326A81EF86281536B17ECCDF80B4052B568DCC4DD5CED6D7D360DF80EDFB8667B64A2E063889E1A4D06E47370DFABB265A675389B7A8E3A7F60AD552ADD106E4C292413CEDFD46F7CCBAF66F072C63E7060060518273B931BE3C979C8EB5233C45B6360071AE27EB23CC54D86746B2A93803B12AFE463738656E7CFF92CA4E823D3C76DA981C207C006777CE7EAC7B85B61C53F56DA98E9E39C6A3752C0E9525E131899B58BEFF04456DAA82AD6ED8AB804B64D47E1AD4C998DED59F0265776453647CFFAD5C67522CE170BD24811185255F5A

# OFFER LESS GROUPS THAN SUPPORTED

Groups           = secp256r1 x25519
Offered_Groups   = secp256r1
Rng_Data         = 49af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea5005
Expected_Content = 0045001700410486E8631CECD233F133F6FC99156D8BB504DB91DEC753C31AEA8AEC3C874221653C986F7B1D00FD4EBFD3F48BCC2CDE3E9C94442B4F53BF2F906B3ECEE6EA12F0

Groups           = secp256r1 x25519
Offered_Groups   = x25519
Rng_Data         = 49af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea5005
Expected_Content = 0024001d002099381de560e4bd43d23d8e435a7dbafeb3c06e51c13cae4d5413691e529aaf2c

# OFFER MULTIPLE GROUPS (implicitly supported)

Groups           = x25519 secp256r1
Rng_Data         = 49af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea500549af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea5005
Expected_Content = 0069001d002099381de560e4bd43d23d8e435a7dbafeb3c06e51c13cae4d5413691e529aaf2c001700410486E8631CECD233F133F6FC99156D8BB504DB91DEC753C31AEA8AEC3C874221653C986F7B1D00FD4EBFD3F48BCC2CDE3E9C94442B4F53BF2F906B3ECEE6EA12F0

Groups           = x25519 ffdhe/ietf/2048 secp256r1
Rng_Data         = 49af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea500549af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea500549af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540
Expected_Content = 016D001D002099381DE560E4BD43D23D8E435A7DBAFEB3C06E51C13CAE4D5413691E529AAF2C010001004854C74CDEB35C2DD056CC4F2CBF21C2E5A2E09803B7C7B9E040621CF1A9DA9D2EE334B0A8A6EC52B534C223EB14A14E41EE4BC2FB75C95292035EA869D9D5D1C25C648E55F5D6E0885257F971C981ED14B4FFF0C54D1C703AEFE72FB2B2721D52649F21D5E7F956EADE5BE93530AA8FA47D4970ACF6DCDD56F010D59549C510C9C3B8EF4E9F4D96B23AB450B32762EC7729CD95328F3F53B841A6555AFAEF8E5F1C7533AEBE75BE62AF07ECE1F1EE80D72835E654EA9BECE03BAFD25BE9F1EE3C027F55947EFF34AC0BC9C43E32944D44FCEEE462E91680FF7648B95BE4FF7CAB60A9AB66775BBD8494CFFF1ED6F7338124C9E03C9A972247B36FF6AC72C07800170041044DA674B121DF2EBD2A5A3174706E80F7A9B2D16ADC1F19FF47D9299DE5649895E182AE8CCA8C97E50F90C316DC2CFEC54D230D004492AC834E984B321190C8DA

Groups           = x25519 ffdhe/ietf/2048 secp256r1
Offered_Groups   = x25519 secp256r1 ffdhe/ietf/2048
Rng_Data         = 49af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea500549af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea500549af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540
Expected_Content = 016D001D002099381DE560E4BD43D23D8E435A7DBAFEB3C06E51C13CAE4D5413691E529AAF2C010001004854C74CDEB35C2DD056CC4F2CBF21C2E5A2E09803B7C7B9E040621CF1A9DA9D2EE334B0A8A6EC52B534C223EB14A14E41EE4BC2FB75C95292035EA869D9D5D1C25C648E55F5D6E0885257F971C981ED14B4FFF0C54D1C703AEFE72FB2B2721D52649F21D5E7F956EADE5BE93530AA8FA47D4970ACF6DCDD56F010D59549C510C9C3B8EF4E9F4D96B23AB450B32762EC7729CD95328F3F53B841A6555AFAEF8E5F1C7533AEBE75BE62AF07ECE1F1EE80D72835E654EA9BECE03BAFD25BE9F1EE3C027F55947EFF34AC0BC9C43E32944D44FCEEE462E91680FF7648B95BE4FF7CAB60A9AB66775BBD8494CFFF1ED6F7338124C9E03C9A972247B36FF6AC72C07800170041044DA674B121DF2EBD2A5A3174706E80F7A9B2D16ADC1F19FF47D9299DE5649895E182AE8CCA8C97E50F90C316DC2CFEC54D230D004492AC834E984B321190C8DA

# OFFER GROUPS THAT ARE NOT SUPPORTED
# expected: unsupported groups are silently ignored 

Groups           = secp256r1 x25519
Offered_Groups   = x25519 secp384r1
Rng_Data         = 49af42ba7f7994852d713ef2784bcbcaa7911de26adc5642cb634540e7ea5005
Expected_Content = 0024001d002099381de560e4bd43d23d8e435a7dbafeb3c06e51c13cae4d5413691e529aaf2c

# MAKE NO OFFERS

Groups           = x25519 secp256r1
Offered_Groups   = none
Rng_Data         = 
Expected_Content = 0000
